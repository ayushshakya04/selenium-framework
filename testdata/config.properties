testdata_UrlMCD = https://finopsmcd.cloudeq.com
testdata_Emailid = finops-testuser1@cloudeq.com
testdata_password = Puda396478
testdata_signin_message = SSO Sign in
SQL_Dashboard_TotalPeriodCost_6days=SELECT SUM(total_cost) AS total_cost FROM ceq_az_service_cost WHERE cost_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE
SQL_Dashboard_TotalPeriodCost_6days_columnname=total_cost
SQL_Dashboard_PreviousMonthCost=SELECT SUM(total_cost) AS total_cost FROM ceq_az_service_cost WHERE DATE_FORMAT(cost_date, '%Y-%m') = DATE_FORMAT(CURRENT_DATE - INTERVAL 1 MONTH, '%Y-%m')
SQL_Dashboard_ThisYearCost=SELECT sum(total_cost) as total_cost FROM ceq_az_service_cost where EXTRACT( YEAR FROM cost_date) =EXTRACT( YEAR FROM CURRENT_DATE())
SQL_Dashboard_SavingsAvailable=SELECT(SELECT SUM(saving) FROM ceq_az_idle_resource_react WHERE resource_id NOT IN (SELECT resourceid FROM ceq_az_idle_resource_savings UNION ALL SELECT resourceid FROM ceq_az_idle_resource_archived)) + coalesce((SELECT SUM(PaYGo_Savings) FROM ceq_az_vm_recommendation where ResourceId NOT IN (SELECT ResourceId FROM ceq_az_vm_recommendation_savings UNION ALL SELECT ResourceId FROM ceq_az_idle_resource_archived) and  result in ('Memory_Downsize', 'VM_Downsize')),0) + coalesce((SELECT SUM(orphanedSavings) FROM ceq_az_snapshots_info_data where snapshotid NOT IN (SELECT snapshotid FROM ceq_az_snapshots_info_savings UNION ALL SELECT snapshotid FROM ceq_az_idle_resource_archived) and MarkedforDelete='Yes' ),0) AS unblended_cost
SQL_Dashboard_IdleResourceCount=SELECT COUNT(ResourceId) as idleresources from ceq_az_idle_resource WHERE ResourceId IS NOT NULL and resourceid NOT IN (SELECT resourceid FROM ceq_az_idle_resource_savings UNION ALL SELECT resourceid FROM ceq_az_idle_resource_archived)
SQL_Dashboard_rightsizing_count=SELECT COUNT(ResourceId) as rightsizing from ceq_az_vm_recommendation WHERE ResourceId IS NOT null and result in ('Memory_Downsize', 'VM_Downsize') and  ResourceId NOT IN (SELECT ResourceId FROM ceq_az_vm_recommendation_savings UNION ALL SELECT ResourceId FROM ceq_az_idle_resource_archived)
SQL_Dashboard_snapshotcount=SELECT COUNT(snapshotId) as snapshot from ceq_az_snapshots_info_data WHERE snapshotId IS NOT null and MarkedforDelete='Yes' and snapshotid NOT IN (SELECT snapshotid FROM ceq_az_snapshots_info_savings UNION ALL SELECT snapshotid FROM ceq_az_snapshots_info_archived)
SQL_Dashboard_savingtilldate=SELECT COALESCE(SUM(total_savings), 0) AS unblended_cost FROM (SELECT SUM(COALESCE(idle.saving, 0)) AS total_savings FROM ceq_az_idle_resource_savings  AS idle UNION ALL SELECT SUM(PaYGo_Savings) AS total_savings FROM ceq_az_vm_recommendation_savings WHERE result in ('Memory_Downsize', 'VM_Downsize')UNION ALL SELECT SUM(orphanedSavings) AS total_savings FROM ceq_az_snapshots_info_savings WHERE MarkedforDelete='Yes') AS totalsavingsavailable
SQL_Dashboard_COSTSBYSERVICES=select category, sum(total_cost) as total_cost from ceq_az_service_cost where cost_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE group by category
SQL_IdleResource_Total_IdleResource_Cost=SELECT count(a.RESOURCE_ID) as idle_resource_count, sum(a.saving) as unblended_cost FROM ceq_az_idle_resource_react a LEFT JOIN (select resourceid FROM ceq_az_idle_resource_savings union select resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE b.resourceid IS NULL
SQL_IdleResource_Total_IdleResourceCost_columnname=unblended_cost
SQL_IdleResource_Total_IdleResource_Count=SELECT COUNT(a.resource_id) as total_data FROM ceq_az_idle_resource_react  a LEFT JOIN(SELECT resourceid FROM ceq_az_idle_resource_savings UNION SELECT resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE b.resourceid IS NULL
SQL_IdleResource_Total_IdleResource_Count_columnname=total_data
SQL_IdleResource_AvailableSavings_Cost=SELECT count(a.RESOURCE_ID) as idle_resource_count, sum(a.saving) as unblended_cost FROM ceq_az_idle_resource_react a LEFT JOIN (select resourceid FROM ceq_az_idle_resource_savings union select resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE b.resourceid IS NULL
SQL_IdleResource_SavingstillDate_Cost=select sum(saving) as unblended_cost FROM ceq_az_idle_resource_savings
SQL_IdleResource_ResourceType_Cost_Count=select a.resource_type,sum(a.saving), count(a.resource_type) from ceq_az_idle_resource_react a LEFT JOIN (select resourceid FROM ceq_az_idle_resource_savings union select resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE b.resourceid IS NULL group by a.resource_type
SQL_IdleResource_ResourceType_Cost_Count_columnname=resource_type
SQL_IdleResource_Graph_7days_Cost_Count_ElasticIps=SELECT COUNT(a.resource_id) as count, SUM(a.saving) as unblended_cost FROM ceq_az_idle_resource_react a LEFT JOIN(SELECT resourceid FROM ceq_az_idle_resource_savings UNION SELECT resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE a.idle_days between 0 and 7 AND a.resource_type ='Public IP Address' and b.resourceid IS NULL
SQL_IdleResource_Graph_Count_ElasticIp_columnname=count
SQL_IdleResource_Graph_Cost_ElasticIp_columnname=unblended_cost
SQL_IdleResource_Graph_morethan31days_Cost_Count_VMs=SELECT COUNT(a.resource_id) as count, SUM(a.saving) as unblended_cost FROM ceq_az_idle_resource_react a LEFT JOIN(SELECT resourceid FROM ceq_az_idle_resource_savings UNION SELECT resourceid FROM ceq_az_idle_resource_archived) b ON a.resource_id = b.resourceid WHERE a.idle_days>31 AND a.resource_type ='Virtual Machine' and b.resourceid IS NULL
SQL_IdleREsource_Status=SELECT savings.saved_status FROM ceq_az_idle_resource_react resource LEFT JOIN ceq_az_idle_resource_status savings ON savings.resource_id = resource.resource_id WHERE resource.account_name='MCD-CORP-PROD-01'and resource.resource_id ='
SQL_VM_RECOMMENDATIONS_Active_Frist_section_ALLtypes_Cost_Count=SELECT COUNT(*) AS total,COUNT(CASE WHEN recomm.result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN recomm.resourceid END) AS downsize_count,SUM(CASE WHEN recomm.result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN recomm.paygo_savings END) * 730 AS downsize_savings_pm,SUM(recomm.current_ph_price) * 730 AS current_costs_pm,SUM(recomm.projected_paygo_price) * 730 AS projected_costs_pm,SUM(CASE WHEN recomm.result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN recomm.paygo_savings END) * 730 AS projected_savings_pm,(SELECT SUM(paygo_savings) FROM ceq_az_vm_recommendation_savings WHERE result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize')) * 730 AS savings_till_date_pm FROM ceq_az_vm_recommendation recomm left join ceq_az_vm_recommendation_status stat on stat.resourceid = recomm.resourceid WHERE( stat.saved_status not in ('archived', 'done', 'discarded') or stat.saved_status is NULL) AND recomm.resourceid not in (select resourceid from ceq_az_vm_recommendation_savings caers)
SQL_VM_RECOMMENDATIONS_Archive_Frist_section_ALLtypes_Cost_Count=SELECT COUNT(*) AS total,COUNT(CASE WHEN result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN ResourceId END) AS upsize_count,SUM(CASE WHEN result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN paygo_savings END) * 730 AS upsize_savings_pm,SUM(CASE WHEN result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN current_ph_price END) * 730 AS upsize_cost_pm,COUNT(CASE WHEN result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN ResourceId END) AS downsize_count,SUM(CASE WHEN result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN paygo_savings END) * 730 AS downsize_savings_pm,SUM(CASE WHEN result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN current_ph_price END) * 730 AS downsize_cost_pm,SUM(current_ph_price) * 730 AS current_costs_pm,SUM(projected_paygo_price) * 730 AS projected_costs_pm,(SELECT SUM(paygo_savings) FROM ceq_az_vm_recommendation_status WHERE result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize')AND saved_status in ('archived')) * 730 AS opportunities_missed_pm,(SELECT COUNT(*) FROM ceq_az_vm_recommendation WHERE true AND ResourceId not in (select ResourceId from ceq_az_vm_recommendation_status caera where caera.saved_status in ('archived'))AND ResourceId not in (select ResourceId from ceq_az_vm_recommendation_savings caers)) AS recommendations_active FROM ceq_az_vm_recommendation_status WHERE true AND saved_status in ('archived')
SQL_VM_RECOMMENDATIONS_Active_Upsize_ALLtypes_Cost_Count=SELECT COUNT(*) AS total,COUNT(CASE WHEN recomm.result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN recomm.resourceid END) AS upsize_count,SUM(CASE WHEN recomm.result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN recomm.paygo_savings END) * 730 AS upsize_savings_pm,SUM(recomm.current_ph_price) * 730 AS current_costs_pm,SUM(recomm.projected_paygo_price) * 730 AS projected_costs_pm,SUM(CASE WHEN recomm.result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') THEN recomm.paygo_savings END) * 730 AS projected_savings_pm,(SELECT SUM(paygo_savings) FROM ceq_az_vm_recommendation_savings WHERE result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize') ) * 730 AS savings_till_date_pm FROM ceq_az_vm_recommendation recomm left join ceq_az_vm_recommendation_status stat on stat.resourceid = recomm.resourceid WHERE ( stat.saved_status not in ('archived', 'done', 'discarded') or stat.saved_status is NULL)AND recomm.resourceid not in (select resourceid from ceq_az_vm_recommendation_savings caers)
SQL_VM_RECOMMENDATIONS_Archive_Upsize_ALLtypes_Cost_Count=SELECT COUNT(*) AS total,COUNT(CASE WHEN result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN ResourceId END) AS upsize_count,SUM(CASE WHEN result IN ('Memory_Upsize', 'VM_Upsize', 'CPU_Upsize') THEN paygo_savings END) * 730 AS upsize_savings_pm,SUM(current_ph_price) * 730 AS current_costs_pm,SUM(projected_paygo_price) * 730 AS projected_costs_pm,(SELECT SUM(paygo_savings) FROM ceq_az_vm_recommendation_status WHERE result IN ('Memory_Downsize', 'VM_Downsize', 'CPU_Downsize')AND saved_status in ('archived')) * 730 AS opportunities_missed_pm,(SELECT COUNT(*) FROM ceq_az_vm_recommendation WHERE true AND ResourceId not in (select ResourceId from ceq_az_vm_recommendation_status caera where caera.saved_status in ('archived'))AND ResourceId not in (select ResourceId from ceq_az_vm_recommendation_savings caers)) AS recommendations_active FROM ceq_az_vm_recommendation_status WHERE true AND saved_status in ('archived')

SQL_Dashboard_MeterValue=SELECT COUNT(DISTINCT metername) AS meterCount FROM ceq_az_cost WHERE metername IS NOT NULL

SQL_Snapshot_Active_FisrSection_All=SELECT COUNT(*) AS total_snapshot, SUM(ciar.snapshotcost) AS cost, COUNT(CASE WHEN ciar.snapshotage BETWEEN 7 AND 15 THEN 1 ELSE NULL END) AS custom_count_7_to_15, COUNT(CASE WHEN ciar.snapshotage BETWEEN 16 AND 30 THEN 1 ELSE NULL END) AS custom_count_16_to_30, COUNT(CASE WHEN ciar.snapshotage >= 31 THEN 1 ELSE NULL END) AS custom_more_than_31, COUNT(CASE WHEN ciar.tags IS NULL OR ciar.tags = '' THEN 1 ELSE NULL END) AS snapshot_untagged, SUM(CASE WHEN ciar.tags IS NULL OR ciar.tags = '' THEN ciar.snapshotcost ELSE 0 END) AS total_untagged_cost, SUM(CASE WHEN LOWER(ciar.markedfordelete) = 'yes' THEN 1 ELSE 0 END) AS Orphaned_snapshot, SUM(CASE WHEN LOWER(ciar.markedfordelete) = 'yes' THEN ciar.snapshotcost ELSE 0 END) AS total_orphaned_savings FROM ceq_az_snapshots_info_data ciar LEFT JOIN ceq_az_snapshots_status cass ON cass.snapshotid = ciar.snapshotid WHERE ciar.snapshotage >= 7 AND (cass.saved_status NOT IN ('archived', 'done', 'discarded') OR cass.saved_status IS NULL)
SQL_Saving_Cost_ThisYear=select sum(T.cost) from (select sum(ir.saving) as cost from ceq_az_idle_resource_savings ir union all select sum(recomm.paygo_savings * 730) as cost from ceq_az_vm_recommendation_savings recomm union all select sum(snapshot.snapshotcost) as cost from ceq_az_snapshots_info_savings snapshot) as T
SQL_Saving_Cost_PreviousMonth=SELECT SUM(total_cost) AS total_savings FROM (SELECT SUM(a.saving) AS total_cost FROM ceq_az_idle_resource_savings a WHERE DATE(a.created_at) BETWEEN (LAST_DAY(CURDATE() - INTERVAL 2 MONTH) + INTERVAL 1 DAY)AND (LAST_DAY(CURDATE() - INTERVAL 1 MONTH))UNION SELECT SUM(a.paygo_savings) * 730 AS total_cost FROM ceq_az_vm_recommendation_savings a WHERE DATE(a.created_at) BETWEEN (LAST_DAY(CURDATE() - INTERVAL 2 MONTH) + INTERVAL 1 DAY)AND (LAST_DAY(CURDATE() - INTERVAL 1 MONTH))UNION SELECT SUM(a.totalcost) AS total_cost FROM ceq_az_snapshots_info_savings a WHERE DATE(a.created_at) BETWEEN (LAST_DAY(CURDATE() - INTERVAL 2 MONTH) + INTERVAL 1 DAY)AND (LAST_DAY(CURDATE() - INTERVAL 1 MONTH))) AS combined_savings
SQL_Saving_Cost_TotalSavings=SELECT SUM(cost) AS total_cost FROM (SELECT SUM(savings.saving) AS cost FROM ceq_az_idle_resource_savings savings WHERE savings.created_at BETWEEN '2024-06-18' AND '2024-06-24 23:59:59'UNION SELECT SUM(savings.PaYGo_Savings) * 730 AS cost FROM ceq_az_vm_recommendation_savings AS savings WHERE savings.created_at BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE UNION SELECT SUM(savings.totalCost) AS cost FROM ceq_az_snapshots_info_savings savings WHERE savings.created_at BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE) AS combined_costs
SQL_Saving_Cost_IdleResource=SELECT count(distinct savings.RESOURCEID) as count,sum(savings.saving) as cost FROM ceq_az_idle_resource_savings savings WHERE savings.created_at BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE
SQL_Saving_Cost_Rightsizing=SELECT COUNT(savings.ResourceId) AS count, SUM(savings.PaYGo_Savings) * 730 AS cost FROM ceq_az_vm_recommendation_savings AS savings WHERE(savings.created_at BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE)
SQL_Saving_Cost_Snapshots=SELECT count(snapshotId) as count,sum(totalCost) as cost FROM ceq_az_snapshots_info_savings savings WHERE(savings.created_at BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 7 DAY) AND CURRENT_DATE)
SQL_Saving_Cost_ProjectedSavings=SELECT SUM(total_savings) AS total_savings FROM (SELECT SUM(a.totalcost) AS total_savings FROM ceq_az_snapshots_info_data a LEFT JOIN (SELECT snapshotid FROM ceq_az_snapshots_info_savings UNION SELECT snapshotid FROM ceq_az_snapshots_info_archived) b ON b.snapshotid = a.snapshotid WHERE b.snapshotid IS NULL UNION SELECT SUM(a.paygo_savings) AS total_savings FROM ceq_az_vm_recommendation a LEFT JOIN (SELECT resourceid FROM ceq_az_vm_recommendation_savings UNION SELECT resourceid FROM ceq_az_vm_recommendation_archived) b ON b.resourceid = a.resourceid WHERE b.resourceid IS NULL UNION SELECT SUM(a.saving) AS total_savings FROM ceq_az_idle_resource_react a LEFT JOIN (SELECT resourceid FROM ceq_az_idle_resource_savings UNION SELECT resourceid FROM ceq_az_idle_resource_archived) b ON b.resourceid = a.resource_id WHERE b.resourceid IS NULL) AS combined_savings
<<<<<<< HEAD
SQL_Saving_Cost_SavingTillDate=SELECT SUM(total_cost) AS total_cost FROM (SELECT SUM(saving) AS total_cost FROM ceq_az_idle_resource_savings UNION SELECT SUM(totalcost) AS total_cost FROM ceq_az_snapshots_info_savings UNION SELECT SUM(paygo_savings) * 730 AS total_cost FROM ceq_az_vm_recommendation_savings) AS combined_costs
=======
SQL_Saving_Cost_SavingTillDate=SELECT SUM(total_cost) AS total_cost FROM (SELECT SUM(saving) AS total_cost FROM ceq_az_idle_resource_savings UNION SELECT SUM(totalcost) AS total_cost FROM ceq_az_snapshots_info_savings UNION SELECT SUM(paygo_savings) * 730 AS total_cost FROM ceq_az_vm_recommendation_savings) AS combined_costs

>>>>>>> aaf5e0e29518f241333e0f788ccd592eb4b1a052
